<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>foy</title>
	<meta name="description" content="Documentation for foy">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">foy</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1>foy</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#foy" id="foy" style="color: inherit; text-decoration: none;">
					<h1>Foy</h1>
				</a>
				<p><a href="https://travis-ci.org/zaaack/foy"><img src="https://travis-ci.org/zaaack/foy.svg?branch=master" alt="Build Status"></a> <a href="https://www.npmjs.com/package/foy"><img src="https://img.shields.io/npm/v/foy.svg" alt="npm"></a> <a href="https://www.npmjs.com/package/foy"><img src="https://img.shields.io/npm/dm/foy.svg" alt="npm"></a> <a href="https://packagephobia.now.sh/result?p=foy"><img src="https://packagephobia.now.sh/badge?p=foy" alt="install size"></a></p>
				<p>A simple, light-weight and modern task runner for general purpose.</p>
				<a href="#contents" id="contents" style="color: inherit; text-decoration: none;">
					<h2>Contents</h2>
				</a>
				<ul>
					<li><a href="#foy">Foy</a><ul>
							<li><a href="#contents">Contents</a></li>
							<li><a href="#features">Features</a></li>
							<li><a href="#install">Install</a></li>
							<li><a href="#write-a-foyfile">Write a Foyfile</a></li>
							<li><a href="#using-with-built-in-promised-based-api">Using with built-in promised-based API</a></li>
							<li><a href="#using-with-other-packages">Using with other packages</a></li>
							<li><a href="#using-dependencies">Using dependencies</a></li>
							<li><a href="#using-namespaces">Using namespaces</a></li>
							<li><a href="#useful-utils">Useful utils</a><ul>
									<li><a href="#fs">fs</a></li>
									<li><a href="#logger">logger</a></li>
									<li><a href="#exec-command">exec command</a></li>
								</ul>
							</li>
							<li><a href="#using-in-ci-servers">Using in CI servers</a></li>
							<li><a href="#using-lifecycle-hooks">Using lifecycle hooks</a></li>
							<li><a href="#run-task-in-task">run task in task</a></li>
							<li><a href="#watch-and-build">Watch and build</a></li>
							<li><a href="#using-with-custom-compiler">Using with custom compiler</a></li>
							<li><a href="#zshbash-auto-completion-new">zsh/bash auto completion (<strong>New!!!</strong>)</a></li>
							<li><a href="#api-documentation">API documentation</a></li>
							<li><a href="#license">License</a></li>
						</ul>
					</li>
				</ul>
				<a href="#features" id="features" style="color: inherit; text-decoration: none;">
					<h2>Features</h2>
				</a>
				<ul>
					<li>Promise-based tasks and built-in utilities.</li>
					<li><a href="https://github.com/shelljs/shelljs" target="_blank">shelljs</a>-like commands</li>
					<li>Easy to learn, stop spending hours for build tools.</li>
					<li>Small install size<ul>
							<li>foy: <a href="https://packagephobia.now.sh/result?p=foy"><img src="https://packagephobia.now.sh/badge?p=foy" alt="install size"></a></li>
							<li>gulp: <a href="https://packagephobia.now.sh/result?p=gulp"><img src="https://packagephobia.now.sh/badge?p=gulp" alt="install size"></a></li>
							<li>grunt: <a href="https://packagephobia.now.sh/result?p=grunt"><img src="https://packagephobia.now.sh/badge?p=grunt" alt="install size"></a></li>
						</ul>
					</li>
				</ul>
				<p><img src="https://github.com/zaaack/foy/blob/master/docs/capture.gif?raw=true" alt="GIF"></p>
				<a href="#install" id="install" style="color: inherit; text-decoration: none;">
					<h2>Install</h2>
				</a>
				<pre><code class="language-sh">yarn add -D foy <span class="hljs-comment"># or npm i -D foy</span></code></pre>
				<p>Or install globally with</p>
				<pre><code class="language-sh">yarn add -g foy <span class="hljs-comment"># or npm i -g foy</span></code></pre>
				<a href="#write-a-foyfile" id="write-a-foyfile" style="color: inherit; text-decoration: none;">
					<h2>Write a Foyfile</h2>
				</a>
				<p>You need to add a Foyfile.js(or Foyfile.ts with <a href="https://github.com/TypeStrong/ts-node">ts-node</a> installed) to your project root.</p>
				<p>Also, you can simply generate a Foyfile.js via:</p>
				<pre><code class="language-sh">foy --init</code></pre>
				<p>which will create a simple <code>Foyfile.js</code> in the current folder:</p>
				<pre><code class="language-js"><span class="hljs-comment">// Foyfile.js</span>
<span class="hljs-keyword">const</span> { task } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;foy&#x27;</span>)

task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;tsc&#x27;</span>)
})</code></pre>
				<p>You can also generate a <code>Foyfile.ts</code> via</p>
				<pre><code class="language-sh">foy --init ts</code></pre>
				<p>Then we can run <code>foy build</code> to execute the <code>build</code> task.</p>
				<pre><code class="language-sh">foy build</code></pre>
				<p>You can also add some options and a description to your tasks:</p>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { task, desc, option, strict } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>

desc(<span class="hljs-string">&#x27;Build ts files with tsc&#x27;</span>)
option(<span class="hljs-string">&#x27;-w, --watch&#x27;</span>, <span class="hljs-string">&#x27;watch file changes&#x27;</span>)
strict() <span class="hljs-comment">// This will throw an error if you passed some options that doesn&#x27;t defined via `option()`</span>
task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">`tsc <span class="hljs-subst">${ctx.options.watch ? <span class="hljs-string">&#x27;-w&#x27;</span> : <span class="hljs-string">&#x27;&#x27;</span>}</span>`</span>)
})</code></pre>
				<pre><code class="language-sh">foy build -w</code></pre>
				<p>Warning! If you want to set flags like strict for all tasks, please use <code>setGlobalOptions</code>:</p>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { setGlobalOptions } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>

setGlobalOptions({ strict: <span class="hljs-literal">true</span> }) <span class="hljs-comment">// all tasks&#x27; options will be strict.</span>

option(<span class="hljs-string">&#x27;-aa&#x27;</span>) <span class="hljs-comment">// strict via default</span>
task(<span class="hljs-string">&#x27;dev&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {

})
option(<span class="hljs-string">&#x27;-bb&#x27;</span>) <span class="hljs-comment">// strict via default</span>
task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {

})
</code></pre>
				<a href="#using-with-built-in-promised-based-api" id="using-with-built-in-promised-based-api" style="color: inherit; text-decoration: none;">
					<h2>Using with built-in promised-based API</h2>
				</a>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { fs, task } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>

task(<span class="hljs-string">&#x27;some task&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  <span class="hljs-keyword">await</span> fs.rmrf(<span class="hljs-string">&#x27;/some/dir/or/file&#x27;</span>) <span class="hljs-comment">// Remove directory or file</span>
  <span class="hljs-keyword">await</span> fs.copy(<span class="hljs-string">&#x27;/src&#x27;</span>, <span class="hljs-string">&#x27;/dist&#x27;</span>) <span class="hljs-comment">// Copy folder or file</span>
  <span class="hljs-keyword">let</span> json = <span class="hljs-keyword">await</span> fs.readJson(<span class="hljs-string">&#x27;./xx.json&#x27;</span>)
  <span class="hljs-keyword">await</span> ctx
    .env(<span class="hljs-string">&#x27;NODE_ENV&#x27;</span>, <span class="hljs-string">&#x27;production&#x27;</span>)
    .cd(<span class="hljs-string">&#x27;./src&#x27;</span>)
    .exec(<span class="hljs-string">&#x27;some command&#x27;</span>) <span class="hljs-comment">// Execute an command</span>
  <span class="hljs-keyword">let</span> { stdout } = <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;ls&#x27;</span>, { stdio: <span class="hljs-string">&#x27;pipe&#x27;</span> }) <span class="hljs-comment">// Get the stdout, default is empty because it&#x27;s redirected to current process via `stdio: &#x27;inherit&#x27;`.</span>
})</code></pre>
				<a href="#using-with-other-packages" id="using-with-other-packages" style="color: inherit; text-decoration: none;">
					<h2>Using with other packages</h2>
				</a>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { task, logger } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>

task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> axios.get(<span class="hljs-string">&#x27;https://your.server/data.json&#x27;</span>)
  logger.info(res.data)
})</code></pre>
				<a href="#using-dependencies" id="using-dependencies" style="color: inherit; text-decoration: none;">
					<h2>Using dependencies</h2>
				</a>
				<pre><code class="language-ts">
<span class="hljs-keyword">import</span> { task } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>

task(<span class="hljs-string">&#x27;test&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;mocha&#x27;</span>)
})

task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> axios.get(<span class="hljs-string">&#x27;https://your.server/data.json&#x27;</span>)
  <span class="hljs-built_in">console</span>.log(res.data)
  <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;build my awesome project&#x27;</span>)
})
task(
  <span class="hljs-string">&#x27;publish:patch&#x27;</span>,
  [<span class="hljs-string">&#x27;test&#x27;</span>, <span class="hljs-string">&#x27;build&#x27;</span>], <span class="hljs-comment">// Run test and build before publish</span>
  <span class="hljs-keyword">async</span> ctx =&gt; {
    <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;npm version patch&#x27;</span>)
    <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;npm publish&#x27;</span>)
  }
)</code></pre>
				<p>Dependencies run serially by default but you can specify when a task should be run concurrently.</p>
				<p>Example: Passing running options to dependencies:</p>
				<pre><code class="language-ts">task(
  <span class="hljs-string">&#x27;publish:patch&#x27;</span>,
  [{
    name: <span class="hljs-string">&#x27;test&#x27;</span>,
    <span class="hljs-keyword">async</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// run test parallelly</span>
    force: <span class="hljs-literal">true</span>, <span class="hljs-comment">// force rerun test whether it has been executed before or not.</span>
  }, {
    name: <span class="hljs-string">&#x27;build&#x27;</span>,
    <span class="hljs-keyword">async</span>: <span class="hljs-literal">true</span>,
    force: <span class="hljs-literal">true</span>,
  },],
  <span class="hljs-keyword">async</span> ctx =&gt; {
    <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;npm version patch&#x27;</span>)
    <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;npm publish&#x27;</span>)
  }
)

<span class="hljs-comment">/* Sugar version */</span>
task(
  <span class="hljs-string">&#x27;publish:patch&#x27;</span>,
  [ <span class="hljs-string">&#x27;test&#x27;</span>.async().force(),
    <span class="hljs-string">&#x27;build&#x27;</span>.async().force() ],
  <span class="hljs-keyword">async</span> ctx =&gt; {
    <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;npm version patch&#x27;</span>)
    <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;npm publish&#x27;</span>)
  }
)

<span class="hljs-comment">/*
Priority for async tasks

Default is 0, higher values will be run earlier; so, in this next example, `build` will be run before `test`.
(Note: If you have multiple async dependencies with same priority, they will be executed in parallel.)
*/</span>
task(
  <span class="hljs-string">&#x27;publish:patch&#x27;</span>,
  [ <span class="hljs-string">&#x27;test&#x27;</span>.async(<span class="hljs-number">0</span>).force(),
    <span class="hljs-string">&#x27;build&#x27;</span>.async(<span class="hljs-number">1</span>).force() ],
  <span class="hljs-keyword">async</span> ctx =&gt; {
    <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;npm version patch&#x27;</span>)
    <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;npm publish&#x27;</span>)
  }
)</code></pre>
				<p>You can also pass options to dependencies:</p>
				<pre><code class="language-ts">task(<span class="hljs-string">&#x27;task1&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  <span class="hljs-built_in">console</span>.log(ctx.options) <span class="hljs-comment">// &quot;{ forceRebuild: true, lazyOptions: 1 }&quot;</span>
  <span class="hljs-built_in">console</span>.log(ctx.global.options) <span class="hljs-comment">// options from command line &quot;{ a: 1 }&quot;</span>
})


task(<span class="hljs-string">&#x27;task2&#x27;</span>, [{
  name: <span class="hljs-string">&#x27;task1&#x27;</span>,
  options: {
    forceRebuild: <span class="hljs-literal">true</span>,
  },
  <span class="hljs-comment">// Some options that rely on ctx or asynchronization,</span>
  <span class="hljs-comment">// it will be merged to options.</span>
  resolveOptions: <span class="hljs-keyword">async</span> ctx =&gt; {
    <span class="hljs-keyword">return</span> { lazyOptions: <span class="hljs-number">1</span> }
  }
}])

<span class="hljs-comment">// foy task2 -a 1</span></code></pre>
				<a href="#using-namespaces" id="using-namespaces" style="color: inherit; text-decoration: none;">
					<h2>Using namespaces</h2>
				</a>
				<p>To avoid name collisions, Foy provides namespaces to group tasks via the <code>namespace</code> function:</p>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { task, <span class="hljs-keyword">namespace</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>

<span class="hljs-keyword">namespace</span>(<span class="hljs-string">&#x27;client&#x27;</span>, <span class="hljs-function"><span class="hljs-params">ns</span> =&gt;</span> {
  before(<span class="hljs-function">() =&gt;</span> {
    logger.info(<span class="hljs-string">&#x27;before&#x27;</span>)
  })
  after(<span class="hljs-function">() =&gt;</span> {
    logger.info(<span class="hljs-string">&#x27;after&#x27;</span>)
  })
  onerror(<span class="hljs-function">() =&gt;</span> {
    logger.info(<span class="hljs-string">&#x27;onerror&#x27;</span>)
  })
  task(<span class="hljs-string">&#x27;start&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; { <span class="hljs-comment">/* ... */</span> }) <span class="hljs-comment">// client:start</span>
  task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; { <span class="hljs-comment">/* ... */</span> }) <span class="hljs-comment">// client:build</span>
  task(<span class="hljs-string">&#x27;watch&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; { <span class="hljs-comment">/* ... */</span> }) <span class="hljs-comment">// client:watch</span>
  <span class="hljs-keyword">namespace</span>(<span class="hljs-string">&#x27;proj1&#x27;</span>, <span class="hljs-function"><span class="hljs-params">ns</span> =&gt;</span> { <span class="hljs-comment">// nested namespace</span>
    onerror(<span class="hljs-function">() =&gt;</span> {
      logger.info(<span class="hljs-string">&#x27;onerror&#x27;</span>, ns)
    })
    task(<span class="hljs-string">&#x27;start&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; { <span class="hljs-comment">/* ... */</span> }) <span class="hljs-comment">// client:proj1:start</span>

  })
})

<span class="hljs-keyword">namespace</span>(<span class="hljs-string">&#x27;server&#x27;</span>, <span class="hljs-function"><span class="hljs-params">ns</span> =&gt;</span> {
  task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; { <span class="hljs-comment">/* ... */</span> }) <span class="hljs-comment">// server:build</span>
  task(<span class="hljs-string">&#x27;start&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; { <span class="hljs-comment">/* ... */</span> }) <span class="hljs-comment">// server:start</span>
  task(<span class="hljs-string">&#x27;watch&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; { <span class="hljs-comment">/* ... */</span> }) <span class="hljs-comment">// server:watch</span>
})

task(<span class="hljs-string">&#x27;start&#x27;</span>, [<span class="hljs-string">&#x27;client:start&#x27;</span>.async(), <span class="hljs-string">&#x27;server:start&#x27;</span>.async()]) <span class="hljs-comment">// start</span>

<span class="hljs-comment">// foy start</span>
<span class="hljs-comment">// foy client:build</span></code></pre>
				<a href="#useful-utils" id="useful-utils" style="color: inherit; text-decoration: none;">
					<h2>Useful utils</h2>
				</a>
				<a href="#fs" id="fs" style="color: inherit; text-decoration: none;">
					<h3>fs</h3>
				</a>
				<p>Foy wraps the NodeJS&#39;s <code>fs</code> (file system) module with a promise-based API, so you can easily use async/await patterns, if you prefer. Foy also implements some useful utility functions for build scripts not present in NodeJS&#39;s built-in modules.</p>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { fs } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>


task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  <span class="hljs-keyword">let</span> f = <span class="hljs-keyword">await</span> fs.readFileSync(<span class="hljs-string">&#x27;./assets/someFile&#x27;</span>)

  <span class="hljs-comment">// copy file or directory</span>
  <span class="hljs-keyword">await</span> fs.copy(<span class="hljs-string">&#x27;./fromPath&#x27;</span>, <span class="hljs-string">&#x27;./toPath&#x27;</span>)

  <span class="hljs-comment">// watch a directory</span>
  <span class="hljs-keyword">await</span> fs.watchDir(<span class="hljs-string">&#x27;./src&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">event, filename</span>) =&gt;</span> {
    logger.info(event, filename)
  })

  <span class="hljs-comment">// make directory with parent directories</span>
  <span class="hljs-keyword">await</span> fs.mkdirp(<span class="hljs-string">&#x27;./some/directory/with/parents/not/exists&#x27;</span>)

  <span class="hljs-comment">// write file will auto create missing parent directories</span>
  <span class="hljs-keyword">await</span> fs.outputFile(<span class="hljs-string">&#x27;./some/file/with/parents/not/exists&#x27;</span>, <span class="hljs-string">&#x27;file data&#x27;</span>)

  <span class="hljs-comment">// write json file will auto create missing parent directories</span>
  <span class="hljs-keyword">await</span> fs.outputJson(<span class="hljs-string">&#x27;./some/file/with/parents/not/exists&#x27;</span>, {text: <span class="hljs-string">&#x27;json data&#x27;</span>})
  <span class="hljs-keyword">let</span> file = <span class="hljs-keyword">await</span> fs.readJson(<span class="hljs-string">&#x27;./some/jsonFile&#x27;</span>)

  <span class="hljs-comment">// iterate directory tree</span>
  <span class="hljs-keyword">await</span> fs.iter(<span class="hljs-string">&#x27;./src&#x27;</span>, <span class="hljs-keyword">async</span> (path, stat) =&gt; {
    <span class="hljs-keyword">if</span> (stat.isDirectory()) {
      logger.info(<span class="hljs-string">&#x27;directory:&#x27;</span>, path)
      <span class="hljs-comment">// skip scan node_modules</span>
      <span class="hljs-keyword">if</span> (path.endsWith(<span class="hljs-string">&#x27;node_modules&#x27;</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (stat.isFile()) {
      logger.warn(<span class="hljs-string">&#x27;file:&#x27;</span>, path)
    }
  })
})</code></pre>
				<a href="#logger" id="logger" style="color: inherit; text-decoration: none;">
					<h3>logger</h3>
				</a>
				<p>Foy includes a light-weight built-in logger</p>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { logger } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>

task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {

  logger.debug(<span class="hljs-string">&#x27;debug&#x27;</span>, { aa: <span class="hljs-number">1</span>})
  logger.info(<span class="hljs-string">&#x27;info&#x27;</span>)
  logger.warn(<span class="hljs-string">&#x27;warn&#x27;</span>)
  logger.error(<span class="hljs-string">&#x27;error&#x27;</span>)

})
</code></pre>
				<a href="#exec-command" id="exec-command" style="color: inherit; text-decoration: none;">
					<h3>exec command</h3>
				</a>
				<p>A simple wrapper for sindresorhus&#39;s lovely module
				<a href="https://github.com/sindresorhus/execa">execa</a></p>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { logger } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>

task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;tsc&#x27;</span>)

  <span class="hljs-comment">// run multiple commands synchronously</span>
  <span class="hljs-keyword">await</span> ctx.exec([
    <span class="hljs-string">&#x27;tsc --outDir ./lib&#x27;</span>,
    <span class="hljs-string">&#x27;tsc --module es6 --outDir ./es&#x27;</span>,
  ])

  <span class="hljs-comment">// run multiple commands concurrently</span>
  <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all([
    ctx.exec(<span class="hljs-string">&#x27;eslint&#x27;</span>),
    ctx.exec(<span class="hljs-string">&#x27;tsc&#x27;</span>),
    ctx.exec(<span class="hljs-string">&#x27;typedoc&#x27;</span>),
  ])
  <span class="hljs-comment">// restart process when file changes</span>
  ctx.monitor(<span class="hljs-string">&#x27;./src&#x27;</span>, <span class="hljs-string">&#x27;node ./dist&#x27;</span>)
  ctx.monitor(<span class="hljs-string">&#x27;./src&#x27;</span>, [<span class="hljs-string">&#x27;rm -rf dist&#x27;</span>, <span class="hljs-string">&#x27;tsc&#x27;</span>, <span class="hljs-string">&#x27;node dist&#x27;</span>])
  ctx.monitor(<span class="hljs-string">&#x27;./src&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">await</span> ctx.run(<span class="hljs-string">&#x27;build:server&#x27;</span>)
    <span class="hljs-keyword">await</span> ctx.exec(<span class="hljs-string">&#x27;node ./dist&#x27;</span>) <span class="hljs-comment">// auth detect long-running process when using ctx.exec</span>
  })
  ctx.monitor(<span class="hljs-string">&#x27;./src&#x27;</span>, <span class="hljs-keyword">async</span> (p) =&gt; {
    <span class="hljs-comment">// manually point out the process need to be killed when restart</span>
    p.current = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;child_process&#x27;</span>).exec(<span class="hljs-string">&#x27;node dist&#x27;</span>)
  })
})

</code></pre>
				<a href="#using-in-ci-servers" id="using-in-ci-servers" style="color: inherit; text-decoration: none;">
					<h2>Using in CI servers</h2>
				</a>
				<p>If you use Foy in CI servers, you won&#39;t want the <a href="https://github.com/sindresorhus/cli-spinners">loading spinners</a> as most CI servers will log stdout and stderr in discreet frames not meant for continuous streaming animations. Luckily, Foy has already considered this! You can simply disable the loading animation like this:</p>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { task, setGlobalOptions } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>

setGlobalOptions({ loading: <span class="hljs-literal">false</span> }) <span class="hljs-comment">// disable loading animations</span>

task(<span class="hljs-string">&#x27;test&#x27;</span>, <span class="hljs-keyword">async</span> cyx =&gt; { <span class="hljs-comment">/* ... */</span> })
<span class="hljs-comment">/*
$ foy test
DependencyGraph for task [test]:
â”€ test

Task: test
...
*/</span></code></pre>
				<a href="#using-lifecycle-hooks" id="using-lifecycle-hooks" style="color: inherit; text-decoration: none;">
					<h2>Using lifecycle hooks</h2>
				</a>
				<p>You can add lifecycle hooks via the <code>before</code>, <code>after</code>, and <code>onerror</code> functions.</p>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { before, after, onerror } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;foy&#x27;</span>
before(<span class="hljs-function">() =&gt;</span> { <span class="hljs-comment">// do something before all tasks tree start</span>
  <span class="hljs-comment">// ...</span>
})
after(<span class="hljs-function">() =&gt;</span> { <span class="hljs-comment">// do something after all tasks tree finished</span>
  <span class="hljs-comment">// ...</span>
})
onerror(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> { <span class="hljs-comment">// do something when error happens</span>
  <span class="hljs-comment">// ...</span>
})</code></pre>
				<a href="#run-task-in-task" id="run-task-in-task" style="color: inherit; text-decoration: none;">
					<h2>run task in task</h2>
				</a>
				<pre><code class="language-ts">
task(<span class="hljs-string">&#x27;task1&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; { <span class="hljs-comment">/* ... */</span> })
task(<span class="hljs-string">&#x27;task2&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  <span class="hljs-comment">// do things before task1</span>

  <span class="hljs-comment">// run task1 manually, so we can</span>
  <span class="hljs-comment">// do things before or after it</span>
  <span class="hljs-keyword">await</span> ctx.run(<span class="hljs-string">&#x27;task1&#x27;</span>)

  <span class="hljs-comment">// do things after task1</span>
})
</code></pre>
				<a href="#watch-and-build" id="watch-and-build" style="color: inherit; text-decoration: none;">
					<h2>Watch and build</h2>
				</a>
				<pre><code class="language-ts">
task(<span class="hljs-string">&#x27;build&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; { <span class="hljs-comment">/* build your project */</span> })
task(<span class="hljs-string">&#x27;run&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; { <span class="hljs-comment">/* start your project */</span> })

<span class="hljs-keyword">let</span> p = <span class="hljs-literal">null</span>
task(<span class="hljs-string">&#x27;watch&#x27;</span>, <span class="hljs-keyword">async</span> ctx =&gt; {
  ctx.fs.watchDir(<span class="hljs-string">&#x27;./src&#x27;</span>, <span class="hljs-keyword">async</span> (evt, file) =&gt; {
    <span class="hljs-keyword">await</span> ctx.run(<span class="hljs-string">&#x27;build&#x27;</span>)
    p &amp;&amp; !p.killed &amp;&amp; p.kill()
    p = <span class="hljs-keyword">await</span> ctx.run(<span class="hljs-string">&#x27;run&#x27;</span>)
  })
})</code></pre>
				<a href="#using-with-custom-compiler" id="using-with-custom-compiler" style="color: inherit; text-decoration: none;">
					<h2>Using with custom compiler</h2>
				</a>
				<pre><code class="language-sh">
<span class="hljs-comment"># Write Foyfile in ts, enabled by default</span>
foy -r ts-node/register -c ./some/Foyfile.ts build

<span class="hljs-comment"># Write Foyfile in coffee</span>
foy -r coffeescript/register -c ./some/Foyfile.coffee build
</code></pre>
				<a href="#zshbash-auto-completion-new" id="zshbash-auto-completion-new" style="color: inherit; text-decoration: none;">
					<h2>zsh/bash auto completion (<strong>New!!!</strong>)</h2>
				</a>
				<p>Add foy auto completion in zsh/bash:</p>
				<pre><code class="language-sh"><span class="hljs-comment"># for bash</span>
foy --completion-profile &gt;&gt; ~/.bashrc

<span class="hljs-comment"># for zsh</span>
foy --completion-profile &gt;&gt; ~/.zshrc</code></pre>
				<a href="#api-documentation" id="api-documentation" style="color: inherit; text-decoration: none;">
					<h2>API documentation</h2>
				</a>
				<p><a href="https://zaaack.github.io/foy/api">https://zaaack.github.io/foy/api</a></p>
				<a href="#license" id="license" style="color: inherit; text-decoration: none;">
					<h2>License</h2>
				</a>
				<p>MIT</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class="label tsd-is-external">
						<span>Externals</span>
					</li>
					<li class=" tsd-kind-namespace tsd-is-external">
						<a href="modules/taskoptions.html">Task<wbr>Options</a>
					</li>
					<li class=" tsd-kind-namespace tsd-is-external">
						<a href="modules/__global.html">__global</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-enum tsd-is-external">
						<a href="enums/taskstate.html" class="tsd-kind-icon">Task<wbr>State</a>
					</li>
					<li class=" tsd-kind-class tsd-is-external">
						<a href="classes/cliloading.html" class="tsd-kind-icon">Cli<wbr>Loading</a>
					</li>
					<li class=" tsd-kind-class tsd-has-type-parameter tsd-is-external">
						<a href="classes/depbuilder.html" class="tsd-kind-icon">Dep<wbr>Builder</a>
					</li>
					<li class=" tsd-kind-class tsd-is-external">
						<a href="classes/logger.html" class="tsd-kind-icon">Logger</a>
					</li>
					<li class=" tsd-kind-class tsd-is-external">
						<a href="classes/shellcontext.html" class="tsd-kind-icon">Shell<wbr>Context</a>
					</li>
					<li class=" tsd-kind-class tsd-has-type-parameter tsd-is-external">
						<a href="classes/taskcontext.html" class="tsd-kind-icon">Task<wbr>Context</a>
					</li>
					<li class=" tsd-kind-class tsd-is-external">
						<a href="classes/taskmanager.html" class="tsd-kind-icon">Task<wbr>Manager</a>
					</li>
					<li class=" tsd-kind-interface tsd-is-external">
						<a href="interfaces/depstree.html" class="tsd-kind-icon">Deps<wbr>Tree</a>
					</li>
					<li class=" tsd-kind-interface tsd-is-external">
						<a href="interfaces/globaloptions.html" class="tsd-kind-icon">Global<wbr>Options</a>
					</li>
					<li class=" tsd-kind-interface tsd-is-external">
						<a href="interfaces/iloginfo.html" class="tsd-kind-icon">ILog<wbr>Info</a>
					</li>
					<li class=" tsd-kind-interface tsd-is-external">
						<a href="interfaces/iloggerprops.html" class="tsd-kind-icon">ILogger<wbr>Props</a>
					</li>
					<li class=" tsd-kind-interface tsd-is-external">
						<a href="interfaces/optionconfig.html" class="tsd-kind-icon">Option<wbr>Config</a>
					</li>
					<li class=" tsd-kind-interface tsd-is-external">
						<a href="interfaces/props.html" class="tsd-kind-icon">Props</a>
					</li>
					<li class=" tsd-kind-interface tsd-is-external">
						<a href="interfaces/rundepoptions.html" class="tsd-kind-icon">Run<wbr>Dep<wbr>Options</a>
					</li>
					<li class=" tsd-kind-interface tsd-is-external">
						<a href="interfaces/runtaskoptions.html" class="tsd-kind-icon">Run<wbr>Task<wbr>Options</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter tsd-is-external">
						<a href="interfaces/task.html" class="tsd-kind-icon">Task</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter tsd-is-external">
						<a href="interfaces/taskdep.html" class="tsd-kind-icon">Task<wbr>Dep</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-is-external">
						<a href="globals.html#callback" class="tsd-kind-icon">Callback</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-is-external">
						<a href="globals.html#dependency" class="tsd-kind-icon">Dependency</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-is-external">
						<a href="globals.html#listenernames" class="tsd-kind-icon">Listener<wbr>Names</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-is-external">
						<a href="globals.html#loglevels" class="tsd-kind-icon">Log<wbr>Levels</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-is-external">
						<a href="globals.html#optiondef" class="tsd-kind-icon">Option<wbr>Def</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-has-type-parameter tsd-is-external">
						<a href="globals.html#taskfn" class="tsd-kind-icon">Task<wbr>Fn</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-is-external">
						<a href="globals.html#watchdirhandler" class="tsd-kind-icon">Watch<wbr>Dir<wbr>Handler</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-is-external">
						<a href="globals.html#watchdiroptions" class="tsd-kind-icon">Watch<wbr>Dir<wbr>Options</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-external">
						<a href="globals.html#defaultlogfile" class="tsd-kind-icon">Default<wbr>Log<wbr>File</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-external">
						<a href="globals.html#eexist" class="tsd-kind-icon">EEXIST</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-external">
						<a href="globals.html#enoent" class="tsd-kind-icon">ENOENT</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-external">
						<a href="globals.html#tmkey" class="tsd-kind-icon">TMKey</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-external">
						<a href="globals.html#logger" class="tsd-kind-icon">logger</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-external">
						<a href="globals.html#objuid" class="tsd-kind-icon">obj<wbr>Uid</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-external">
						<a href="globals.html#objuidmap" class="tsd-kind-icon">obj<wbr>Uid<wbr>Map</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-external">
						<a href="globals.html#shellparser" class="tsd-kind-icon">shell<wbr>Parser</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-external">
						<a href="globals.html#spawn" class="tsd-kind-icon">spawn</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#_exec" class="tsd-kind-icon">_exec</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#after" class="tsd-kind-icon">after</a>
					</li>
					<li class=" tsd-kind-function tsd-has-type-parameter tsd-is-external">
						<a href="globals.html#appendcallback" class="tsd-kind-icon">append<wbr>Callback</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#before" class="tsd-kind-icon">before</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#copy" class="tsd-kind-icon">copy</a>
					</li>
					<li class=" tsd-kind-function tsd-has-type-parameter tsd-is-external">
						<a href="globals.html#debounce" class="tsd-kind-icon">debounce</a>
					</li>
					<li class=" tsd-kind-function tsd-has-type-parameter tsd-is-external">
						<a href="globals.html#defaults" class="tsd-kind-icon">defaults</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#dep" class="tsd-kind-icon">dep</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#desc" class="tsd-kind-icon">desc</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#exec" class="tsd-kind-icon">exec</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#formatdate" class="tsd-kind-icon">format<wbr>Date</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#makelogger" class="tsd-kind-icon">make<wbr>Logger</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#namespace" class="tsd-kind-icon">namespace</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#onerror" class="tsd-kind-icon">onerror</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#option" class="tsd-kind-icon">option</a>
					</li>
					<li class=" tsd-kind-function tsd-has-type-parameter tsd-is-external">
						<a href="globals.html#promisequeue" class="tsd-kind-icon">promise<wbr>Queue</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#setglobaloptions" class="tsd-kind-icon">set<wbr>Global<wbr>Options</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#setoption" class="tsd-kind-icon">set<wbr>Option</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#shell" class="tsd-kind-icon">shell</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#sleep" class="tsd-kind-icon">sleep</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#strict" class="tsd-kind-icon">strict</a>
					</li>
					<li class=" tsd-kind-function tsd-has-type-parameter tsd-is-external">
						<a href="globals.html#task" class="tsd-kind-icon">task</a>
					</li>
					<li class=" tsd-kind-function tsd-is-external">
						<a href="globals.html#watchdir" class="tsd-kind-icon">watch<wbr>Dir</a>
					</li>
					<li class=" tsd-kind-object-literal tsd-is-external">
						<a href="globals.html#is" class="tsd-kind-icon">Is</a>
					</li>
					<li class=" tsd-kind-object-literal tsd-is-external">
						<a href="globals.html#loglevels" class="tsd-kind-icon">Log<wbr>Levels</a>
					</li>
					<li class=" tsd-kind-object-literal tsd-is-external">
						<a href="globals.html#fs" class="tsd-kind-icon">fs</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>